## This Day In Family History (Precomputed)


This repository is my pile of hacks to generate "this day in family history" information for every day of the year, just like the [GRAMPS Plugin](https://gramps-project.org/wiki/index.php/Addon:This_Day_In_Family_History).

This puts the "this day in family history" data in a format that can be put on a website without requiring the publishing of an entire gramps database or something like that.

This repo is mostly throwaway-quality code to fill my need for this. If you decide to use it, know that:
- I have only ever used it on COPIES of my GRAMPS databases
- The initial code was initially written by Generative AI based on the [original addon's code](https://github.com/gramps-project/addons-source/tree/maintenance/gramps60/ThisDayInFamilyHistory)
- I am brand new to GRAMPS development and have no idea what "the proper way" to do any of this should be
- I run Linux


## Setup

some of this may be optional
```
sudo apt install libgirepository-2.0-dev gir1.2-osmgpsmap-1.0
```

1. download and unpack gramps source tarball somewhere
    - example: https://github.com/gramps-project/gramps/archive/refs/tags/v6.0.6/v6.0.6.tar.gz
2. `export GRAMPS_RESOURCES=.venv/share`
3. MAKE A COPY OF YOUR GRAMPS DB FOLDER
   - im brand new to coding stuff with gramps. this whole repo is an ugly hack. it will probably make the original developers cry. Do not trust me with your precious family tree.
4. `uv run onthisday.py <path to gramps-6.0.6 or your unpacked source tarball> <path to your gramps dir>`
   - example: `uv run onthisday.py ../gramps-6.0.6 ./679ec8cb`
5. dismiss the dialog(s) that pop up
6. your events are now in json format in the folder `daily_events`


## Embedding

Now you have the json data, you can populate it on your website

```html
  <p id="this-day-in-history"></p>
  <script src="script.js"></script>
```

script.js (generated by AI, adjust as you wish):
```javascript
document.addEventListener('DOMContentLoaded', () => {
    const today = new Date();
    const month = (today.getMonth() + 1).toString().padStart(2, '0'); // Months are 0-indexed
    const day = today.getDate().toString().padStart(2, '0');

    const filename = `daily_events/events_${month}_${day}.json`;
    const container = document.getElementById('this-day-in-history');

    fetch(filename)
        .then(response => {
            if (!response.ok) {
                if (response.status === 404) {
                    throw new Error('No events found for today.');
                }
                throw new Error('Network response was not ok.');
            }
            return response.json();
        })
        .then(data => {
            if (data.length > 0) {
                const ul = document.createElement('ul');
                data.forEach(event => {
                    const li = document.createElement('li');
                    // You might want to link the name to a profile page using event.gramps_id or a direct handle if your site supports it
                    li.textContent = event.description;
                    ul.appendChild(li);
                });
                container.innerHTML = `<h2>On ${today.toLocaleDateString('en-US', {month: 'long', day: 'numeric'})} in Family History:</h2>`;
                container.appendChild(ul);
            } else {
                container.innerHTML = `<h2>On ${today.toLocaleDateString('en-US', {month: 'long', day: 'numeric'})} in Family History:</h2><p>... nothing happened (thats known about)!</p>`;
            }
        })
        .catch(error => {
            console.error('Error fetching daily events:', error);
            container.innerHTML = `<h2>On ${today.toLocaleDateString('en-US', {month: 'long', day: 'numeric'})} in Family History:</h2><p>No events found for today.</p>`;
        });
});
```
